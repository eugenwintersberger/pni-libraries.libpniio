

<!doctype html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>NeXus path’s: pni::nexus::Path &#8212; libpninexus 2.0.0 documentation</title>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bizstyle.css" type="text/css" />
    
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script src="../_static/bizstyle.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Searching for objects" href="nexus_search.html" />
    <link rel="prev" title="Retrieving objects" href="nexus_retrieval.html" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0" />
    <!--[if lt IE 9]>
    <script src="_static/css3-mediaqueries.js"></script>
    <![endif]-->
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="nexus_search.html" title="Searching for objects"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="nexus_retrieval.html" title="Retrieving objects"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">libpninexus 2.0.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >Users guide</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="nexus.html" >NeXus support</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="nexus_retrieval.html" accesskey="U">Retrieving objects</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">NeXus path’s: <code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">pni::nexus::Path</span></code></a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="nexus-path-s-pni-nexus-path">
<h1>NeXus path’s: <a class="reference internal" href="../api/nexus_path.html#_CPPv4N3pni5nexus4PathE" title="pni::nexus::Path"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">pni::nexus::Path</span></code></a><a class="headerlink" href="#nexus-path-s-pni-nexus-path" title="Permalink to this headline">¶</a></h1>
<p>Until now we discussed only the basic properties of a NeXus path.
As these paths are rather powerful tools this chapter is entirely dedicated
to such paths.</p>
<div class="section" id="the-structure-of-a-nexus-path">
<h2>The structure of a Nexus path<a class="headerlink" href="#the-structure-of-a-nexus-path" title="Permalink to this headline">¶</a></h2>
<p>In comparison to a plain HDF5 path the NeXus path as provided by <em>libpninexus</em>
has to additional features</p>
<ul class="simple">
<li><p>it includes the name of the file and thus could be used by command line
programs to entirely determine the location of an object</p></li>
<li><p>it is able to address attributes (<code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">hdf5::Path</span></code> can only address
node objects within a file).</p></li>
</ul>
<p>To describe the anatomy of a NeXus path in <em>libpninexus</em> we consider the following
example</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">/home/user/data/experiment.nxs://run_001:NXentry/:NXinstrument/:NXdetector/data&#64;units</span></code></p>
</div></blockquote>
<p>where we can identify all three sections comprising a <em>libpninexus</em> NeXus path</p>
<ul class="simple">
<li><p><em>file section</em> - <code class="docutils literal notranslate"><span class="pre">/home/user/data/experiment.nxs:/</span></code></p></li>
<li><p><em>node section</em> - <code class="docutils literal notranslate"><span class="pre">/run_001:NXentry/:NXinstrument/:NXdetector/data</span></code></p></li>
<li><p><em>attribute section</em> - <code class="docutils literal notranslate"><span class="pre">units</span></code></p></li>
</ul>
<p>In more detail these three sections describe</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 28%" />
<col style="width: 72%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Section</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><em>file section</em></p></td>
<td><p>which references the NeXus-file on the file system.
It must thus be a valid file system path on the
operating system platform in use.</p></td>
</tr>
<tr class="row-odd"><td><p><em>node section</em></p></td>
<td><p>describing the location of an node within the file</p></td>
</tr>
<tr class="row-even"><td><p><em>attribute section</em></p></td>
<td><p>referencing an attribute attached to the object
pointed to by the residual path. The attribute is
identified by its name.</p></td>
</tr>
</tbody>
</table>
<p>The <em>file-</em> and the <em>node-section</em> are separated by <code class="docutils literal notranslate"><span class="pre">:/</span></code> and the <em>node-</em> and
the <em>attribute-section</em> are separated by a <code class="docutils literal notranslate"><span class="pre">&#64;</span></code> symbol.
Each element in the <em>node-section</em> of the path consists of two path</p>
<ul class="simple">
<li><p>the nodes link name</p></li>
<li><p>and an optional base class type</p></li>
</ul>
<p>separated by a semicolon. The base class type part only makes sense if a
group should be referenced as individual fields (or datasets in HDF5
terminology) are not associated with a base class type.
There are three permitted forms how a node element could look like</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 76%" />
<col style="width: 1%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>node element</p></th>
<th class="head"><p>description</p></th>
<th class="head"></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">name:class</span></code></p></td>
<td><p>this would be the full description of a base class
including the name of the link to the group as well
as the base class type it belongs to.</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">name</span></code></p></td>
<td><p>only the name of the link. Something like this could
be used for both: groups and fields.</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">:class</span></code></p></td>
<td><p>references a group by the base class type it belongs
to.</p></td>
<td></td>
</tr>
</tbody>
</table>
<p>A path is considered as <em>absolute</em> if its <em>node section</em> starts at the root
group of the file. This is always  the case if</p>
<ul class="simple">
<li><p>the <em>file section</em> of the path is not empty (if we give a file the
<em>node section</em> has to start at the root node and thus must be absolute)</p></li>
<li><p>or, if no <em>file section</em> is given, the <em>object section</em> starts with a
leading <code class="docutils literal notranslate"><span class="pre">/</span></code>.</p></li>
</ul>
<p>The latter condition is equivalent to the convention used for Unix file system
paths while the former requires some explanation.</p>
</div>
<div class="section" id="equality-and-matching-of-paths">
<h2>Equality and matching of paths<a class="headerlink" href="#equality-and-matching-of-paths" title="Permalink to this headline">¶</a></h2>
<div class="section" id="equality">
<h3>Equality<a class="headerlink" href="#equality" title="Permalink to this headline">¶</a></h3>
<p>The equality of two NeXus paths is rather trivial: two paths can be considered
equal if all of their elements are equal.</p>
</div>
<div class="section" id="matching">
<h3>Matching<a class="headerlink" href="#matching" title="Permalink to this headline">¶</a></h3>
<p>Two paths are considered as <em>matching</em> if they are not equal but capable of
referencing the same object within a single file.
To illustrate this situation consider the following three paths</p>
<ol class="arabic simple">
<li><p><em>a = /entry/instrument/detector/data</em></p></li>
<li><p><em>b = /entry:NXentry/instrument:NXinstrument/detector:NXdetector/data</em></p></li>
<li><p><em>c = /:NXentry/:NXinstrument/:NXdetector/data</em></p></li>
</ol>
<p>each being perfectly well defined NeXus paths referencing the data field in
a detector group.
It is obvious for path <code class="xref cpp cpp-var docutils literal notranslate"><span class="pre">a</span></code> and <code class="xref cpp cpp-var docutils literal notranslate"><span class="pre">b</span></code> that they reference the
same object. The same is true for the paths <code class="xref cpp cpp-var docutils literal notranslate"><span class="pre">b</span></code> and <code class="xref cpp cpp-var docutils literal notranslate"><span class="pre">c</span></code>.
Surprisingly, <code class="xref cpp cpp-var docutils literal notranslate"><span class="pre">a</span></code> and <code class="xref cpp cpp-var docutils literal notranslate"><span class="pre">c</span></code> do not match. As <code class="xref cpp cpp-var docutils literal notranslate"><span class="pre">a</span></code> does
not provide any type information for each of its nodes we cannot be sure that
it references the same object as <code class="xref cpp cpp-var docutils literal notranslate"><span class="pre">c</span></code>. Being more specific: none of
the groups in <code class="xref cpp cpp-var docutils literal notranslate"><span class="pre">a</span></code> has to be a NeXus group at all.
We get the rough idea that the property of two path of <em>matching</em> each other
has something to do with the number of elements they have common.</p>
<p>In order to derive a reasonable set of rules determining whether or not two
paths are matching we start with deriving rules to deciding under which
conditions the <em>node</em>-elements of the <em>node section</em> of a path are matching.</p>
<p>The first rule covers the trivial case of equality</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Two node elements <em>a</em> and <em>b</em> are considered as <em>matching</em> if they are
equal in the above case: <em>a=b</em>.</p>
</div>
<p>For instance, let <em>a=entry:NXentry</em> and <em>b=entry:NXentry</em> it is obvious that
they are referencing the same node as they are equal in the above sense.</p>
<p>Furthermore, we can propose a second rule</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Two node elements <em>a</em> and <em>b</em> can be considered <em>matching</em> if their class
component is equal and only one of them has the name attribute set.</p>
</div>
<p>This would be the case if <em>a=:NXentry</em> and <em>b=entry:NXentry</em>. This is somehow
logical if we consider that <em>a</em> is just a more general version of <em>b</em>. However,
it is crucial that only one of them has a non empty name attribute. Otherwise
this rule would violate rule one.</p>
<p>Now as we have derived two rules for matching node elements we can generalize
a single rule for paths</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Two paths <em>a</em> and <em>b</em> are considered matching if</p>
<ul class="simple">
<li><p>they are of equal size</p></li>
<li><p>all of their node elements match</p></li>
<li><p>and, if available, they reference the same attribute.</p></li>
</ul>
</div>
</div>
</div>
<div class="section" id="the-pni-nexus-path-type">
<h2>The <a class="reference internal" href="../api/nexus_path.html#_CPPv4N3pni5nexus4PathE" title="pni::nexus::Path"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">pni::nexus::Path</span></code></a> type<a class="headerlink" href="#the-pni-nexus-path-type" title="Permalink to this headline">¶</a></h2>
<p>In C++ a NeXus-path is represented by an instance of
<a class="reference internal" href="../api/nexus_path.html#_CPPv4N3pni5nexus4PathE" title="pni::nexus::Path"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">pni::nexus::Path</span></code></a>.
<a class="reference internal" href="../api/nexus_path.html#_CPPv4N3pni5nexus4PathE" title="pni::nexus::Path"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">pni::nexus::Path</span></code></a> is an
iterable over the elements of the <em>object section</em> of a NeXus-path.
The optional <em>file-</em> and <em>attribute-section</em> can be accessed via getter and
setter methods like this</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">nexus</span><span class="o">::</span><span class="n">Path</span> <span class="n">path</span> <span class="o">=</span> <span class="p">...;</span>
<span class="n">path</span><span class="p">.</span><span class="n">filename</span><span class="p">(</span><span class="s">&quot;/data/run/detector.nxs&quot;</span><span class="p">);</span> <span class="c1">//set file section</span>
<span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">path</span><span class="p">.</span><span class="n">filename</span><span class="p">()</span><span class="o">&lt;&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>   <span class="c1">//retrieve file section</span>
</pre></div>
</div>
<p>and analogously for the <em>attribute section</em></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">nexus</span><span class="o">::</span><span class="n">Path</span> <span class="n">path</span> <span class="o">=</span> <span class="p">...;</span>
<span class="n">path</span><span class="p">.</span><span class="n">attribute</span><span class="p">(</span><span class="s">&quot;units&quot;</span><span class="p">);</span>              <span class="c1">//set attribute section</span>
<span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">path</span><span class="p">.</span><span class="n">units</span><span class="p">()</span><span class="o">&lt;&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>   <span class="c1">//retrieve attribute section</span>
</pre></div>
</div>
<p>The elements of the <em>object section</em> are stored as instances of
<code class="xref cpp cpp-type docutils literal notranslate"><span class="pre">nexus::Path::Element</span></code> which is in fact a type alias for a
<code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">std::pair</span></code> where the first element of the pair stores the
name of the element and the second its class (if available).
Technically, <code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">nexus::Path</span></code> is a thin wrapper around a list of such
<code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">nexus::Path::Element</span></code> (although not all the list functionality
is exported). Consult the API documentation for a detailed description of
<code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">nexus::Path</span></code>’s interface.</p>
<div class="section" id="path-construction">
<h3>Path construction<a class="headerlink" href="#path-construction" title="Permalink to this headline">¶</a></h3>
<p>Though the <code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">nexus::Path</span></code> type has a constructor one would
typically construct a path from a string using the
<code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">nexus::Path::from_string()</span></code> static member method</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">nexus</span><span class="o">::</span><span class="n">Path</span> <span class="n">path</span> <span class="o">=</span> <span class="n">nexus</span><span class="o">::</span><span class="n">Path</span><span class="o">::</span><span class="n">from_string</span><span class="p">(</span><span class="s">&quot;/:NXentry/:NXinstrument/pilatus&quot;</span><span class="p">);</span>
</pre></div>
</div>
<p><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">nexus::Path::from_string()</span></code> has also a static counterpart method
<code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">nexus::Path::to_string()</span></code> which converts a path instance to its
string representation.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">nexus</span><span class="o">::</span><span class="n">Path</span> <span class="n">path</span> <span class="o">=</span> <span class="p">....;</span>
<span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">nexus</span><span class="o">::</span><span class="n">Path</span><span class="o">::</span><span class="n">to_string</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="o">&lt;&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="path-iteration">
<h3>Path iteration<a class="headerlink" href="#path-iteration" title="Permalink to this headline">¶</a></h3>
<p><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">nexus::Path</span></code> provides an STL compliant iterator interface which
allows easy iteration over all elements in the <em>object section</em> of the path.
Consider the following example</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">nexus</span><span class="o">::</span><span class="n">Path</span> <span class="n">p</span> <span class="o">=</span> <span class="n">nexus</span><span class="o">::</span><span class="n">Path</span><span class="o">::</span><span class="n">from_string</span><span class="p">(</span><span class="s">&quot;/:NXentry/:NXinstrument/pilatus/data&quot;</span><span class="p">);</span>

<span class="k">for</span><span class="p">(</span><span class="k">auto</span> <span class="nl">e</span><span class="p">:</span><span class="n">p</span><span class="p">)</span>
   <span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="o">&lt;&lt;</span><span class="s">&quot;name: &quot;</span><span class="o">&lt;&lt;</span><span class="n">e</span><span class="p">.</span><span class="n">first</span><span class="o">&lt;&lt;</span><span class="s">&quot;</span><span class="se">\t</span><span class="s"> type:&quot;</span><span class="o">&lt;&lt;</span><span class="n">e</span><span class="p">.</span><span class="n">second</span><span class="o">&lt;&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</pre></div>
</div>
<p>which would yield the output</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>name: /       type: NXroot
name:         type: NXentry
name:         type: NXinstrument
name: pilatus type:
name: data    type:
</pre></div>
</div>
<p>As we can see from the above example: the first member of the
<code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">nexus::Path::Element</span></code> stored in the object section list is the
name of an object while the second is its type. In the case of a field
only the first (name) element will be set (a field does not have a
particular type).
The number of elements in the <em>object section</em> of <code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">nexus::Path</span></code> can
be obtained via the <code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">nexus::Path::size()</span></code> member function (which is
the same as for any other STL container).</p>
</div>
<div class="section" id="push-and-pop-on-object">
<h3>Push and pop on object<a class="headerlink" href="#push-and-pop-on-object" title="Permalink to this headline">¶</a></h3>
<p>Elements of the <em>object section</em> of the path can be added using the
<code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">push_back()</span></code> and <code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">push_front()</span></code> member functions.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">nexus</span><span class="o">::</span><span class="n">Path</span> <span class="n">p</span> <span class="o">=</span> <span class="n">nexus</span><span class="o">::</span><span class="n">Path</span><span class="o">::</span><span class="n">from_string</span><span class="p">(</span><span class="s">&quot;:NXinstrument&quot;</span><span class="p">);</span>
<span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">p</span><span class="o">&lt;&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span> <span class="c1">// output: :NXinstrument</span>

<span class="n">p</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">object_element</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="s">&quot;NXdetector&quot;</span><span class="p">));</span>
<span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">p</span><span class="o">&lt;&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span> <span class="c1">// output: :NXinstrument/:NXdetector</span>

<span class="n">p</span><span class="p">.</span><span class="n">push_front</span><span class="p">(</span><span class="n">object_element</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="s">&quot;NXentry&quot;</span><span class="p">));</span>
<span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">p</span><span class="o">&lt;&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span> <span class="c1">// output: :NXentry/:NXinstrument/:NXdetector</span>
</pre></div>
</div>
<p>Like other STL containers <code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">nexus::Path</span></code> also provides the
<code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">front()</span></code>, <code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">back()</span></code>, <code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">pop_front()</span></code>, and
<code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">pop_back()</span></code> member functions which have the standard STL behavior.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">nexus</span><span class="o">::</span><span class="n">Path</span> <span class="n">p</span> <span class="o">=</span> <span class="n">nexus</span><span class="o">::</span><span class="n">Path</span><span class="o">::</span><span class="n">from_string</span><span class="p">(</span><span class="s">&quot;:NXentry/:NXinstrument/:NXdetector&quot;</span><span class="p">);</span>

<span class="c1">//get front and back elements from the object section</span>
<span class="n">nexus</span><span class="o">::</span><span class="n">Path</span><span class="o">::</span><span class="n">Element</span> <span class="n">entry</span> <span class="o">=</span> <span class="n">p</span><span class="p">.</span><span class="n">front</span><span class="p">();</span>
<span class="n">nexus</span><span class="o">::</span><span class="n">Path</span><span class="o">::</span><span class="n">Element</span> <span class="n">detector</span> <span class="o">=</span> <span class="n">p</span><span class="p">.</span><span class="n">back</span><span class="p">();</span>

<span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">p</span><span class="o">&lt;&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span> <span class="c1">// output: :NXentry/:NXinstrument/:NXdetector</span>

<span class="c1">//remove front and back objects from the object section</span>
<span class="n">p</span><span class="p">.</span><span class="n">pop_front</span><span class="p">();</span>
<span class="n">p</span><span class="p">.</span><span class="n">pop_back</span><span class="p">();</span>

<span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">p</span><span class="o">&lt;&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span> <span class="c1">// output: :NXinstrument</span>
</pre></div>
</div>
</div>
<div class="section" id="pni-nexus-path-and-hdf5-path">
<h3><a class="reference internal" href="../api/nexus_path.html#_CPPv4N3pni5nexus4PathE" title="pni::nexus::Path"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">pni::nexus::Path</span></code></a> and <code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">hdf5::Path</span></code><a class="headerlink" href="#pni-nexus-path-and-hdf5-path" title="Permalink to this headline">¶</a></h3>
<p>In many cases we may want to construct an HDF5 path from a NeXus path an
vica verse. Now, converting from an HDF5 path to a NeXus path is always
easy as an HDF5 path is also a valid NeXus path (despite the fact that an
HDF5 path cannot address attributes and contains no file information).
For this purpose <a class="reference internal" href="../api/nexus_path.html#_CPPv4N3pni5nexus4PathE" title="pni::nexus::Path"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">pni::nexus::Path</span></code></a> has an implicit
conversion constructor for an HDF5 path.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">hdf5</span><span class="o">::</span><span class="n">Path</span> <span class="n">hdf5_path</span> <span class="o">=</span> <span class="p">...;</span>
<span class="n">pni</span><span class="o">::</span><span class="n">nexus</span><span class="o">::</span><span class="n">Path</span> <span class="n">nexus_path</span> <span class="o">=</span> <span class="n">hdf5_path</span><span class="p">;</span>
</pre></div>
</div>
<p>The other direction is also possible but only under certain conditions.
Unlike a NeXus path an HDF5 path contains only of link names. So conversion from
a NeXus path to an HDF5 path is only possible under the following
restrictions</p>
<ul class="simple">
<li><p>the NeXus path has all the link names set in its <em>node section</em></p></li>
<li><p>the NeXus path does not reference an attribute (an HDF5 path cannot do that)</p></li>
<li><p>the NeXus path has an empty <em>file section</em> - we cannot reference a file
with an HDF5 path.</p></li>
</ul>
<p><a class="reference internal" href="../api/nexus_path.html#_CPPv4N3pni5nexus4PathE" title="pni::nexus::Path"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">pni::nexus::Path</span></code></a> has an implicit conversion operator to
an <code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">hdf5::Path</span></code>. Thus we could use for instance a NeXus path
in situations where an HDF5 path is expected</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">nexus</span><span class="o">::</span><span class="n">Path</span> <span class="n">path</span><span class="o">=</span><span class="n">nexus</span><span class="o">::</span><span class="n">Path</span><span class="o">::</span><span class="n">from_string</span><span class="p">(</span><span class="s">&quot;/entry:NXentry/instrument/detector:NXdetector&quot;</span><span class="p">);</span>

<span class="n">hdf5</span><span class="o">::</span><span class="n">node</span><span class="o">::</span><span class="n">Group</span> <span class="n">detector</span> <span class="o">=</span> <span class="n">hdf5</span><span class="o">::</span><span class="n">node</span><span class="o">::</span><span class="n">get_node</span><span class="p">(</span><span class="n">root_group</span><span class="p">,</span><span class="n">path</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="utility-functions">
<h2>Utility functions<a class="headerlink" href="#utility-functions" title="Permalink to this headline">¶</a></h2>
<div class="section" id="element-utilities">
<h3>Element utilities<a class="headerlink" href="#element-utilities" title="Permalink to this headline">¶</a></h3>
<p>There are a couple of utility functions available to work with the elements
stored in the <em>object section</em> of the path.
One important function is the <code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">object_element()</span></code> function which
creates a single element for the <em>object section</em> of a path. This is
particularly useful in connection with the <code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">push_back()</span></code> and
<code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">push_front()</span></code> member functions of <code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">nexus::Path</span></code>.
If for instance one wants to append a detector group to the object section
we could use</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">nexus</span><span class="o">::</span><span class="n">Path</span> <span class="n">p</span> <span class="o">=</span> <span class="p">...;</span>
<span class="n">p</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">object_element</span><span class="p">(</span><span class="s">&quot;detector&quot;</span><span class="p">,</span><span class="s">&quot;NXdector&quot;</span><span class="p">));</span>
</pre></div>
</div>
<p><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">object_element()</span></code> takes two arguments: the first is the name of the
object while the second its type (only relevant for groups). If both are empty
strings and exception will be thrown.</p>
<p>Furthermore there are some functions for querying the basic properties of an
element instance. Each of these functions returns a boolean value and takes
an instance of <code class="xref cpp cpp-type docutils literal notranslate"><span class="pre">nexus::Path::Element</span></code> as its only argument.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 40%" />
<col style="width: 60%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>utiltiy function</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">is_root_element()</span></code></p></td>
<td><p>returns true if the element references the
root group with name <code class="docutils literal notranslate"><span class="pre">/</span></code> and type
<code class="docutils literal notranslate"><span class="pre">NXroot</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">is_complete()</span></code></p></td>
<td><p>return true if the element has a non-empty
name and type</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">has_name()</span></code></p></td>
<td><p>return true if the element has a non-empty
name</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">has_class()</span></code></p></td>
<td><p>return true if the element has a non-empty
type</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="pni-nexus-path-utilities">
<h3><a class="reference internal" href="../api/nexus_path.html#_CPPv4N3pni5nexus4PathE" title="pni::nexus::Path"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">pni::nexus::Path</span></code></a> utilities<a class="headerlink" href="#pni-nexus-path-utilities" title="Permalink to this headline">¶</a></h3>
<p>Three inquiry functions exist for <code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">nexus::Path</span></code>. Each of them
returns a boolean and takes as their single argument a reference to an
instance of <code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">nexus::Path</span></code></p>
<table class="docutils align-default">
<colgroup>
<col style="width: 48%" />
<col style="width: 52%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>utility function</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">is_absolute()</span></code></p></td>
<td><p>returns <em>true</em> if the path is an
absolute path</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">has_file_section()</span></code></p></td>
<td><p>returns <em>true</em> if the path has a
non-empty file section</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">has_attribute_section()</span></code></p></td>
<td><p>returns <em>true</em> if the path has a
non-empty attribute section</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">is_empty()</span></code></p></td>
<td><p>returns <em>true</em> if a path has neither
a <em>file section</em>, an
<em>attribute section</em>, and an
<em>object section</em>. This situation
would be equivalent to a default
constructed path object.</p></td>
</tr>
</tbody>
</table>
<p>The <code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">split_path()</span></code> function divides an <code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">nexus::Path</span></code> into
two partial paths at a user defined position.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">s</span> <span class="o">=</span> <span class="s">&quot;test.nxs://:NXentry/:NXinstrument/detector@NX_class&quot;</span><span class="p">;</span>
<span class="n">nexus</span><span class="o">::</span><span class="n">Path</span> <span class="n">p</span> <span class="o">=</span> <span class="n">nexus</span><span class="o">::</span><span class="n">Path</span><span class="o">::</span><span class="n">from_string</span><span class="p">(</span><span class="n">s</span><span class="p">);</span>
<span class="n">nexus</span><span class="o">::</span><span class="n">Path</span> <span class="n">instrument_path</span><span class="p">,</span><span class="n">detector_path</span><span class="p">;</span>
<span class="n">split_path</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">instrument_path</span><span class="p">,</span><span class="n">detector_path</span><span class="p">);</span>

<span class="c1">// output: test.nxs://:NXentry/:NXinstrument</span>
<span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">instrument_path</span><span class="o">&lt;&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<span class="c1">// output: detector@NX_class</span>
<span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">detector_path</span><span class="o">&lt;&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</pre></div>
</div>
<p>The second argument to <code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">split_path()</span></code> is the position where to
perform the split. It is the index of the first element for the second path.
To chop of the <em>file section</em> from a path one could use the following code</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">s</span> <span class="o">=</span> <span class="s">&quot;test.nxs://:NXentry/:NXinstrument/detector@NX_class&quot;</span><span class="p">;</span>
<span class="n">nexus</span><span class="o">::</span><span class="n">Path</span> <span class="n">p</span> <span class="o">=</span> <span class="n">nexus</span><span class="o">::</span><span class="n">Path</span><span class="o">::</span><span class="n">from_string</span><span class="p">(</span><span class="n">s</span><span class="p">);</span>
<span class="n">nexus</span><span class="o">::</span><span class="n">Path</span> <span class="n">instrument_path</span><span class="p">,</span><span class="n">detector_path</span><span class="p">;</span>
<span class="n">split_path</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">instrument_path</span><span class="p">,</span><span class="n">detector_path</span><span class="p">);</span>

<span class="c1">// output: test.nxs</span>
<span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">instrument_path</span><span class="o">&lt;&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<span class="c1">// output: /:NXentry/:NXinstrument/detector@NX_class</span>
<span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">detector_path</span><span class="o">&lt;&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</pre></div>
</div>
<p>Two paths can be joined using the <code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">join()</span></code> function.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">nexus</span><span class="o">::</span><span class="n">Path</span> <span class="n">a</span> <span class="o">=</span> <span class="n">nexus</span><span class="o">::</span><span class="n">Path</span><span class="o">::</span><span class="n">from_string</span><span class="p">(</span><span class="s">&quot;file.nxs://:NXentry/:NXinstrument&quot;</span><span class="p">);</span>
<span class="n">nexus</span><span class="o">::</span><span class="n">Path</span> <span class="n">b</span> <span class="o">=</span> <span class="n">nexus</span><span class="o">::</span><span class="n">Path</span><span class="o">::</span><span class="n">from_string</span><span class="p">(</span><span class="s">&quot;pilatus300k:NXdetector/data&quot;</span><span class="p">);</span>
<span class="n">nexus</span><span class="o">::</span><span class="n">Path</span> <span class="n">c</span> <span class="o">=</span> <span class="n">join</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">);</span>
<span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="o">&lt;&lt;</span><span class="n">c</span><span class="o">&lt;&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>

<span class="c1">//would output</span>
<span class="c1">//file.nxs://:NXentry/:NXinstrument/pilatus300k:NXdetector/data&quot;</span>
</pre></div>
</div>
<p>There are several restrictions to the two path arguments <code class="xref cpp cpp-var docutils literal notranslate"><span class="pre">a</span></code> and
<code class="xref cpp cpp-var docutils literal notranslate"><span class="pre">b</span></code> passed to the <code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">join()</span></code> function</p>
<ul class="simple">
<li><p><code class="xref cpp cpp-var docutils literal notranslate"><span class="pre">a</span></code> must not have an <em>attribute section</em></p></li>
<li><p><code class="xref cpp cpp-var docutils literal notranslate"><span class="pre">b</span></code> must not have a <em>file section</em></p></li>
<li><p><code class="xref cpp cpp-var docutils literal notranslate"><span class="pre">b</span></code> must not be an absolute path.</p></li>
</ul>
<p>If any of these restrictions are violated <code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">join()</span></code> throws
<code class="xref cpp cpp-type docutils literal notranslate"><span class="pre">value_error</span></code>. There are additional special conditions which should be
taken into account and where the above rules do not apply</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 55%" />
<col style="width: 45%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>input state</p></th>
<th class="head"><p>result</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="xref cpp cpp-var docutils literal notranslate"><span class="pre">a</span></code> empty, <code class="xref cpp cpp-var docutils literal notranslate"><span class="pre">b</span></code> not</p></td>
<td><p>return <code class="xref cpp cpp-var docutils literal notranslate"><span class="pre">b</span></code> unchanged</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref cpp cpp-var docutils literal notranslate"><span class="pre">b</span></code> empty, <code class="xref cpp cpp-var docutils literal notranslate"><span class="pre">a</span></code> not</p></td>
<td><p>return <code class="xref cpp cpp-var docutils literal notranslate"><span class="pre">a</span></code> unchanged</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref cpp cpp-var docutils literal notranslate"><span class="pre">a</span></code> and <code class="xref cpp cpp-var docutils literal notranslate"><span class="pre">b</span></code> empty</p></td>
<td><p>return an empty path object</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="the-grammar-of-a-nexus-path">
<h2>The grammar of a NeXus path<a class="headerlink" href="#the-grammar-of-a-nexus-path" title="Permalink to this headline">¶</a></h2>
<p>Lets first have a look on the grammar of a Nexus path in
EBNFfootnote{EBNF=Extended Backus Naur Form}</p>
<pre>
<strong id="grammar-token-path-file_path"><span id="grammar-token-file-path"></span>file_path       </strong> ::=  {all characters allowed by the plattform to describe a path}
<strong id="grammar-token-path-valid_char"><span id="grammar-token-valid-char"></span>valid_char      </strong> ::=  &quot;_&quot; | &quot;a-z&quot; | &quot;A-Z&quot; | &quot;0-9&quot;;
<strong id="grammar-token-path-whitespace"><span id="grammar-token-whitespace"></span>whitespace      </strong> ::=  &quot; &quot; | &quot;\n&quot; | &quot;\r&quot;;
<strong id="grammar-token-path-class_seperator"><span id="grammar-token-class-seperator"></span>class_seperator </strong> ::=  &quot;:&quot;;
<strong id="grammar-token-path-object_seperator"><span id="grammar-token-object-seperator"></span>object_seperator</strong> ::=  &quot;/&quot;;
<strong id="grammar-token-path-nexus_id"><span id="grammar-token-nexus-id"></span>nexus_id        </strong> ::=  valid_char,{valid_char};
<strong id="grammar-token-path-nexus_name"><span id="grammar-token-nexus-name"></span>nexus_name      </strong> ::=  nexus_id,(class_seperator|group_separtor|whitespace);
<strong id="grammar-token-path-nexus_group"><span id="grammar-token-nexus-group"></span>nexus_group     </strong> ::=  group_seperator,nexus_id,[group_seperator|whitespace];
<strong id="grammar-token-path-object_id"><span id="grammar-token-object-id"></span>object_id       </strong> ::=  nexus_name | nexus_name,nexus_group | nexus_group
<strong id="grammar-token-path-object_path"><span id="grammar-token-object-path"></span>object_path     </strong> ::=  [&quot;/&quot;],object_id,{&quot;/&quot;,object_id};
<strong id="grammar-token-path-nexus_path"><span id="grammar-token-nexus-path"></span>nexus_path      </strong> ::=  [file_path,&quot;://&quot;],object_path,[&quot;&#64;&quot;,nexus_attr];
</pre>
<p>The <code class="docutils literal notranslate"><span class="pre">file_path</span></code> is platform dependent which makes it difficult to determine
which characters would be allowed in a path. Thus we leave this open to and
separate the file path from everything else by a <code class="docutils literal notranslate"><span class="pre">://</span></code> string terminal.
<code class="docutils literal notranslate"><span class="pre">nexus_id</span></code> describes a repetition of a set of characters allowed in Nexus
names (for groups, fields, attributes, and classes). It is much more restrictive
as for the filename.</p>
</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">NeXus path’s: <code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">pni::nexus::Path</span></code></a><ul>
<li><a class="reference internal" href="#the-structure-of-a-nexus-path">The structure of a Nexus path</a></li>
<li><a class="reference internal" href="#equality-and-matching-of-paths">Equality and matching of paths</a><ul>
<li><a class="reference internal" href="#equality">Equality</a></li>
<li><a class="reference internal" href="#matching">Matching</a></li>
</ul>
</li>
<li><a class="reference internal" href="#the-pni-nexus-path-type">The <code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">pni::nexus::Path</span></code> type</a><ul>
<li><a class="reference internal" href="#path-construction">Path construction</a></li>
<li><a class="reference internal" href="#path-iteration">Path iteration</a></li>
<li><a class="reference internal" href="#push-and-pop-on-object">Push and pop on object</a></li>
<li><a class="reference internal" href="#pni-nexus-path-and-hdf5-path"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">pni::nexus::Path</span></code> and <code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">hdf5::Path</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#utility-functions">Utility functions</a><ul>
<li><a class="reference internal" href="#element-utilities">Element utilities</a></li>
<li><a class="reference internal" href="#pni-nexus-path-utilities"><code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">pni::nexus::Path</span></code> utilities</a></li>
</ul>
</li>
<li><a class="reference internal" href="#the-grammar-of-a-nexus-path">The grammar of a NeXus path</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="nexus_retrieval.html"
                        title="previous chapter">Retrieving objects</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="nexus_search.html"
                        title="next chapter">Searching for objects</a></p>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script><p>
  <h3 class='versions'>Versions</h3>
  <p>
    <ul>
      <li><a class="reference external" href="../index/../../latest/index.html">v:latest</a></li>
      <li><a class="reference external" href="../index/../../stable/index.html">v:stable</a></li>
      
      <li><a class="reference external" href="../index/../../v2.0.0/index.html">v2.0.0</a></li>
      <li><a class="reference external" href="../index/../../v1.2.10/index.html">v1.2.10</a></li>
      
    </ul>
  </p>
</p>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="nexus_search.html" title="Searching for objects"
             >next</a> |</li>
        <li class="right" >
          <a href="nexus_retrieval.html" title="Retrieving objects"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">libpninexus 2.0.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >Users guide</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="nexus.html" >NeXus support</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="nexus_retrieval.html" >Retrieving objects</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">NeXus path’s: <code class="xref cpp cpp-class docutils literal notranslate"><span class="pre">pni::nexus::Path</span></code></a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2018, DESY, Eugen Wintersberger.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 3.4.3.
    </div>
  </body>
</html>